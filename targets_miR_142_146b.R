setwd("~/Desktop/R_scripts/reference/")
miRBase <- read.table(file="high_confidence_miRBase21-master.tsv", header = TRUE, fill = TRUE, sep =  " ")


getRNADuplex<-function(ref_seq,target_seq){
  ref_seq <- gsub("T","U",ref_seq)
  target_seq <- gsub("T","U",target_seq)
  input_data<-c(paste('>ref', sep=''), as.character(ref_seq), paste('>test', sep=''), as.character(target_seq))
  input_file<-'temp-miRNA-seq.fa'
  unlink(input_file)
  file<-file(input_file)
  writeLines(input_data, file)
  close(file)
  energy<-system('RNAduplex < temp-miRNA-seq.fa', intern=T)[3]
  #energy <- substr(energy,nchar(energy)-10,nchar(energy))
  #energy<-gsub("\\(", "\\*", energy)
  #energy<-gsub("\\)", "\\*", energy)
  #energy<-strsplit(energy, "*", fixed=T)[[1]][2]
  #energy<-as.numeric(energy)
  return(energy)
}

# miR-142-5p
getRNADuplex ("CAUAAAGUAGAAAGCACUACU","CAGATGAAAAAAGTTAACATTCAGTACTTTATG") #target scan

# miR-146b-5p LRP2
getRNADuplex ("TGAGAACTGAATTCCATAGGCT","TACTGATTATTTTATTCCAGAGTTCTCAA") #target scan

# miR-146b-5p TIMP3
getRNADuplex ("TGAGAACTGAATTCCATAGGCT","AGAAUCCAGGGCCAUGGGAGAUACAAUUCCAAGUUCUCG") #target scan

# miR-142-5p TIMP3 6mer site
getRNADuplex ("CAUAAAGUAGAAAGCACUACU","AAATTTCGTAGCACTGTTTACAGTTTTCCTCCATGTTATTTATGAATTTTATATTCCGTGAATGTATATTGTCTTGTAATGTTGCATAATGTTCACTTTTTATAGTGTGTCCTTTATTC") #target scan

# miR-142-5p TIMP3 all UTR
all_UTR <- "GCGCCAGACCCTGCCCCACCTCACTTCCCTCCCTTCCCGCTGAGCTTCCCTTGGACACTAACTCTTCCCAGATGATGACAATGAAATTAGTGCCTGTTTTCTTGCAAATTTAGCACTTGGAACATTTAAAGAAAGGTCTATGCTGTCATATGGGGTTTATTGGGAACTATCCTCCTGGCCCCACCCTGCCCCTTCTTTTTGGTTTTGACATCATTCATTTCCACCTGGGAATTTCTGGTGCCATGCCAGAAAGAATGAGGAACCTGTATTCCTCTTCTTCGTGATAATATAATCTCTATTTTTTTAGGAAAACAAAAATGAAAAACTACTCCATTTGAGGATTGTAATTCCCACCCCTCTTGCTTCTTCCCCACCTCACCATCTCCCAGACCCTCTTCCCTTTGCCCTTCTCCTCCAATACATAAAGGACACAGACAAGGAACTTGCTGAAAGGCCAACCATTTCAGGATCAGTCAAAGGCAGCAAGCAGATAGACTCAAGGTGTGTGAAAGATGTTATACACCAGGAGCTGCCACTGCATGTCCCAACCAGACTGTGTCTGTCTGTGTCTGCATGTAAGAGTGAGGGAGGGAAGGAAGGAACTACAAGAGAGTCGGAGATGATGCAGCACACACACAATTCCCCAGCCCAGTGATGCTTGTGTTGACCAGATGTTCCTGAGTCTGGAGCAAGCACCCAGGCCAGAATAACAGAGCTTTCTTAGTTGGTGAAGACTTAAACATCTGCCTGAGGTCAGGAGGCAATTTGCCTGCCTTGTACAAAAGCTCAGGTGAAAGACTGAGATGAATGTCTTTCCTCTCCCTGCCTCCCACCAGACTTCCTCCTGGAAAACGCTTTGGTAGATTTGGCCAGGAGCTTTCTTTTATGTAAATTGGATAAATACACACACCATACACTATCCACAGATATAGCCAAGTAGATTTGGGTAGAGGATACTATTTCCAGAATAGTGTTTAGCTCACCTAGGGGGATATGTTTGTATACACATTTGCATATACCCACATGGGGACATAAGCTAATTTTTTTACAGGACACAGAATTCTGTTCAATGCTGTTAAATATGCCAATAGTTTAATCTCTTCTATTTTGTTGTCGTTGCTTGTTTGAAGAAAATCATGACATTCCAAGTTGACAtttttttttCATTTTAATTAAAATTTGAAATTCTGAACACCGTCAGCACCCTCTCTTCCCTATCATGGGTCATCTGACCCCTGTCCGTCTCCTTGTCCCTGCTTCATGTTTGGGGGCCTTTCTTTAACTGCCTTCCTGGCTTAGCTCAGATGGCAGATGAGAGTGTAGTCAAGGGCCTGGGCACAGGAGGGAGAGCTGCAGAGTGTCCTGCCTGCCTTGGCTGGAGGGACACCTCTCCTGGGTGTGGAGACAGCTTGGTTCCCTTTCCCTAGCTCCCTGGTGGGTGAATGCCACCTCCTGAGATCCTCACCTCTTGGAATTAAAATTGTTGGTCACTGGGGAAAGCCTGAGTTTGCAACCAGTTGTAGGGTTTCTGTTGTGtttttttttttttttttgaaataaaactataatataaattctcctattaaataaaattattttaaGTTTTAGTGTCAAAAGTGAGATGCTGAGAGTAGGTGATAATGTATATTTTACAGAGTGGGGGTTGGCAGGATGGTGACATTGAACATGATTGCTCTCTGTCTCTTTTTTCAGCTTATGGGTATTTATCTTCTATTAGTATTTGTATCTTCAGTTCATTCCACTTTAGGAAACAGAGCTGCCAATTGAAACAGAAGAAGaaaaaaaaaaaaaGCAGCAGACAACACACTGTAGAGTCTTGCACACACACAAGTGCCCAGGCAAGGTGCTTGGCAGAACCGCAGAGTGGGAAGAGAGTACCGGCATCGGGTTTCCTTGGGATCAATTTCATTACCGTGTACCTTTCCCATTGTGGTCATGCCATTTGGCAGGGGGAGAATGGGAGGCTTGGCCTTCTTTGTGAGGCAGTGTGAGCAGAAGCTGATGCCAGCATGTCACTGGTTTTGAAGGGATGAGCCCAGACTTGATGTTTTGGGATTGTCCTTATTTTAACCTCAAGGTCTCGCATGGTGGGGCCCCTGACCAACCTACACAAGTTCCCTCCCACAAGTGGACATCAGTGTCTTCTCTGTGAGGCATCTGGCCATTCGCACTCCCTGGTGTGGTCAGCCTCTCTCACACAAGGAGGAACTTGGGTGAAGGCTGAGTGTGAGGCACCTGAAGTTTCCCTGCGGAGTCGATAAATTAGCAGAACCACATCCCCATCTGTTAGGCCTTGGTGAGGAGGCCCTGGGCAAAGAAGGGTCTTTCGCAAAGCGATGTCAGAGGGCGGTTTTGAGCTTTCTATAAGCTATAGCTTTGTTTATTTCACCCGTTCACTTACTGTATAATTTAAAATCATTTATGTAGCTGAGACACTTCTGTATTTCAATCATATCATGAACATTTTATTTTGCTAAATCTTGTGTCATGTGTAGGCTGTAATATGTGTACATTGTGTTTAAGAGAAAAATGAAACCCACATGCCGCCATTTTCCTGAATCAAATTCTGCAGTGGAATGGAGAGGAAAATACTTCTAGGCAAGCAGCTAGACTGGTGAATTGGGGGAAATAGAAGGAACTAGTAACTGAGACTCCTCCAGCCTCCTCCCTATTGGAATCCCAATGGCTCCTGGAGTAGGAAAAAAGTTTAAACTACATTCATGTTCTTGTTCTGTGTCACTCGGCCCTGGGTAGTCTACCATTTACTTCACCCCAAGTCCTGCTGCCCATCCAGTTGGGAAGCCATGATTTTCCTAAGAATCCAGGGCCATGGGAGATACAATTCCAAGTTCTCGCTTCCTCCTTTGGGCATCTCTTCTGCCTCCCAATCAAGGAAGCTCCATGCTCAGGCTCTCAGCTCTCGGGCCAGTGCTCTGCTCTGTCCAGGGTAGGTAATACTGGGAGACTCCTGTCTTTTACCCTCCCCTCGTTCCAGACCTGCCTCATGGTGGCAACATGGTTCTTGAACAATTAAAGAAACAAATGACTTTTTGGAATAGCCCTGTCTAGGGCAAACTGTGGCCCCCAGGAGACACTACCCTTCCATGCCCCAGACCTCTGTCTTGCATGTGACAATTGACAATCTGGACTACCCCAAGATGGCACCCAAGTGTTTGGCTTCTGGCTACCTAAGGTTAACATGTCACTAGAGTATTTTTATGAGAGACAAACATTATAAAAATCTGATGGCAAAAGCAAAACAAAATGGAAAGTAGGGGAGGTGGATGTGACAACAACTTCCAAATTGGCTCTTTGGAGGCGAGAGGAAGGGGAGAACTTGGAGAATAGTTTTTGCTTTGGGGGTAGAGGCTTCTTAGATTCTCCCAGCATCCGCCTTTCCCTTTAGCCAGTCTGCTGTCCTGAAACCCAGAAGTGATGGAGAGAAACCAACAAGAGATCTCGAACCCTGTCTAGAAGGAATGTATTTGTTGCTAAATTTCGTAGCACTGTTTACAGTTTTCCTCCATGTTATTTATGAATTTTATATTCCGTGAATGTATATTGTCTTGTAATGTTGCATAATGTTCACTTTTTATAGTGTGTCCTTTATTCTAAACAGTAAAGTGGTTTTATTTCTATCACA"
getRNADuplex ("CAUAAAGUAGAAAGCACUACU",all_UTR) #target scan
substr(all_UTR,2946,2966)

# miR-142-5p perfect sites
getRNADuplex ("CAUAAAGUAGAAAGCACUACU","AGTAGTGCTTTCTACTTTATG") #perfect sites

# miR-146b-5p perfect sites
getRNADuplex ("TGAGAACTGAATTCCATAGGCT","CAGCCTATGGAATTCAGTTCTCA") #perfect sites


# miR-142-5p bulged sites
getRNADuplex ("CAUAAAGUAGAAAGCACUACU","AGTAGTGCTTAGTACTTTATG") #bulky sites

# miR-146b-5p bulged sites
getRNADuplex ("TGAGAACTGAATTCCATAGGCT","CAGCCTATGGAAAACAGTTCTCA") #bulky sites

# miR-146a-5p bulged sites
getRNADuplex ("TGAGAACTGAATTCCATGGGTT","CAGCCTATGGAAAACAGTTCTCA") #bulky sites
